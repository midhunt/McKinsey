"0","# How does work type affect the stroke "
"0","WorkTypeSampleGroups <- dtTrain[, .(Samaple_N = .N), "
"0","                                by = ""work_type""][, "
"0","                          Sample_pct := Samaple_N/sum(Samaple_N)]"
"0","WorkTypeStrokeGroups <- dtTrain[stroke == T, .(Stroke_N = .N), "
"0","                            by = ""work_type""][, "
"0","                          Stroke_pct := Stroke_N/sum(Stroke_N)]"
"0","WorkType <- merge(WorkTypeSampleGroups,"
"0","                  WorkTypeStrokeGroups,"
"0","                  by = ""work_type"","
"0","                  all = T)"
"0","WorkType[, c(""Stroke_N"", "
"0","             ""Stroke_pct"") := lapply(.SD, "
"0","                                     function(x){"
"0","                                       x = ifelse(is.na(x), 0, x)"
"0","                                     }), "
"0","         .SDcols = c(""Stroke_N"", "
"0","                     ""Stroke_pct"")]"
"0","WorkType[, N_pct := Stroke_N/Samaple_N]"
"0","ggplot(WorkType) +"
"0","  geom_bar(aes(x = work_type, y = N_pct), stat = ""identity"") +"
"0","  scale_y_continuous(labels = scales::percent) +"
"0","  xlab(""Work Type"") +"
"0","  ylab(""% Patients"") +"
"0","  ggtitle(""Patients Affected With Stroke In Each Age Group"")"
